<!DOCTYPE html>  <html> <head>   <title>math.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="animation-loop.html">                 animation-loop.coffee               </a>                                           <a class="source" href="autocode.html">                 autocode.coffee               </a>                                           <a class="source" href="lexer.html">                 lexer.coffee               </a>                                           <a class="source" href="background-painter.html">                 background-painter.coffee               </a>                                           <a class="source" href="big-cursor.html">                 big-cursor.coffee               </a>                                           <a class="source" href="blend-controls.html">                 blend-controls.coffee               </a>                                           <a class="source" href="code-transformer.html">                 code-transformer.coffee               </a>                                           <a class="source" href="colour-functions.html">                 colour-functions.coffee               </a>                                           <a class="source" href="colour-literals.html">                 colour-literals.coffee               </a>                                           <a class="source" href="editor.html">                 editor.coffee               </a>                                           <a class="source" href="event-router.html">                 event-router.coffee               </a>                                           <a class="source" href="globals.html">                 globals.coffee               </a>                                           <a class="source" href="graphics-commands.html">                 graphics-commands.coffee               </a>                                           <a class="source" href="init.html">                 init.coffee               </a>                                           <a class="source" href="lights-commands.html">                 lights-commands.coffee               </a>                                           <a class="source" href="livecodelab-core.html">                 livecodelab-core.coffee               </a>                                           <a class="source" href="math.html">                 math.coffee               </a>                                           <a class="source" href="matrix-commands.html">                 matrix-commands.coffee               </a>                                           <a class="source" href="parser.html">                 parser.coffee               </a>                                           <a class="source" href="program-loader.html">                 program-loader.coffee               </a>                                           <a class="source" href="program-runner.html">                 program-runner.coffee               </a>                                           <a class="source" href="renderer.html">                 renderer.coffee               </a>                                           <a class="source" href="samplebank.html">                 samplebank.coffee               </a>                                           <a class="source" href="sound-system.html">                 sound-system.coffee               </a>                                           <a class="source" href="text-dimming.html">                 text-dimming.coffee               </a>                                           <a class="source" href="threejs-system.html">                 threejs-system.coffee               </a>                                           <a class="source" href="time-keeper.html">                 time-keeper.coffee               </a>                                           <a class="source" href="ui.html">                 ui.coffee               </a>                                           <a class="source" href="url-router.html">                 url-router.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               math.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>Functions adapted from processing.js</p>             </td>             <td class="code">               <div class="highlight"><pre>
</pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>//////////////////////////////////////////////////////////////////////////
Math functions
//////////////////////////////////////////////////////////////////////////</p>             </td>             <td class="code">               <div class="highlight"><pre>
</pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Calculation</p>             </td>             <td class="code">               <div class="highlight"><pre>
Calculates the absolute value (magnitude) of a number. The absolute value of a number is always positive.

@param {int|float} value   int or float

@returns {int|float}

abs = Math.abs


Calculates the closest int value that is greater than or equal to the value of the parameter.
For example, ceil(9.03) returns the value 10.

@param {float} value   float

@returns {int}

@see floor
@see round

ceil = Math.ceil


Constrains a value to not exceed a maximum and minimum value.

@param {int|float} value   the value to constrain
@param {int|float} value   minimum limit
@param {int|float} value   maximum limit

@returns {int|float}

@see max
@see min

constrain = (aNumber, aMin, aMax) -&gt;
  (if aNumber &gt; aMax then aMax else (if aNumber &lt; aMin then aMin else aNumber))



Calculates the distance between two points.

@param {int|float} x1     int or float: x-coordinate of the first point
@param {int|float} y1     int or float: y-coordinate of the first point
@param {int|float} z1     int or float: z-coordinate of the first point
@param {int|float} x2     int or float: x-coordinate of the second point
@param {int|float} y2     int or float: y-coordinate of the second point
@param {int|float} z2     int or float: z-coordinate of the second point

@returns {float}

dist = -&gt;
  dx = undefined
  dy = undefined
  dz = undefined
  if arguments.length is 4
    dx = arguments[0] - arguments[2]
    dy = arguments[1] - arguments[3]
    return Math.sqrt(dx * dx + dy * dy)
  if arguments.length is 6
    dx = arguments[0] - arguments[3]
    dy = arguments[1] - arguments[4]
    dz = arguments[2] - arguments[5]
    Math.sqrt dx * dx + dy * dy + dz * dz



Returns Euler's number e (2.71828...) raised to the power of the value parameter.

@param {int|float} value   int or float: the exponent to raise e to

@returns {float}

exp = Math.exp


Calculates the closest int value that is less than or equal to the value of the parameter.

@param {int|float} value        the value to floor

@returns {int|float}

@see ceil
@see round

floor = Math.floor


Calculates a number between two numbers at a specific increment. The amt  parameter is the
amount to interpolate between the two values where 0.0 equal to the first point, 0.1 is very
near the first point, 0.5 is half-way in between, etc. The lerp function is convenient for
creating motion along a straight path and for drawing dotted lines.

@param {int|float} value1       float or int: first value
@param {int|float} value2       float or int: second value
@param {int|float} amt          float: between 0.0 and 1.0

@returns {float}

@see curvePoint
@see bezierPoint

lerp = (value1, value2, amt) -&gt;
  ((value2 - value1) * amt) + value1



Calculates the natural logarithm (the base-e logarithm) of a number. This function
expects the values greater than 0.0.

@param {int|float} value        int or float: number must be greater then 0.0

@returns {float}

log = Math.log


Calculates the magnitude (or length) of a vector. A vector is a direction in space commonly
used in computer graphics and linear algebra. Because it has no "start" position, the magnitude
of a vector can be thought of as the distance from coordinate (0,0) to its (x,y) value.
Therefore, mag() is a shortcut for writing "dist(0, 0, x, y)".

@param {int|float} a       float or int: first value
@param {int|float} b       float or int: second value
@param {int|float} c       float or int: third value

@returns {float}

@see dist

mag = (a, b, c) -&gt;
  return Math.sqrt(a * a + b * b + c * c)  if c
  Math.sqrt a * a + b * b



Re-maps a number from one range to another. In the example above, the number '25' is converted from
a value in the range 0..100 into a value that ranges from the left edge (0) to the right edge (width) of the screen.
Numbers outside the range are not clamped to 0 and 1, because out-of-range values are often intentional and useful.

@param {float} value        The incoming value to be converted
@param {float} istart       Lower bound of the value's current range
@param {float} istop        Upper bound of the value's current range
@param {float} ostart       Lower bound of the value's target range
@param {float} ostop        Upper bound of the value's target range

@returns {float}

@see norm
@see lerp

map = (value, istart, istop, ostart, ostop) -&gt;
  ostart + (ostop - ostart) * ((value - istart) / (istop - istart))



Determines the largest value in a sequence of numbers.

@param {int|float} value1         int or float
@param {int|float} value2         int or float
@param {int|float} value3         int or float
@param {int|float} array          int or float array

@returns {int|float}

@see min

max = -&gt;
  return (if arguments[0] &lt; arguments[1] then arguments[1] else arguments[0])  if arguments.length is 2
  numbers = (if arguments.length is 1 then arguments[0] else arguments) # if single argument, array is used
  throw "Non-empty array is expected"  unless "length" of numbers and numbers.length
  max = numbers[0]
  count = numbers.length
  i = 1

  while i &lt; count
    max = numbers[i]  if max &lt; numbers[i]
    ++i
  max



Determines the smallest value in a sequence of numbers.

@param {int|float} value1         int or float
@param {int|float} value2         int or float
@param {int|float} value3         int or float
@param {int|float} array          int or float array

@returns {int|float}

@see max

min = -&gt;
  return (if arguments[0] &lt; arguments[1] then arguments[0] else arguments[1])  if arguments.length is 2
  numbers = (if arguments.length is 1 then arguments[0] else arguments) # if single argument, array is used
  throw "Non-empty array is expected"  unless "length" of numbers and numbers.length
  min = numbers[0]
  count = numbers.length
  i = 1

  while i &lt; count
    min = numbers[i]  if min &gt; numbers[i]
    ++i
  min



Normalizes a number from another range into a value between 0 and 1.
Identical to map(value, low, high, 0, 1);
Numbers outside the range are not clamped to 0 and 1, because out-of-range
values are often intentional and useful.

@param {float} aNumber    The incoming value to be converted
@param {float} low        Lower bound of the value's current range
@param {float} high       Upper bound of the value's current range

@returns {float}

@see map
@see lerp

norm = (aNumber, low, high) -&gt;
  (aNumber - low) / (high - low)



Facilitates exponential expressions. The pow() function is an efficient way of
multiplying numbers by themselves (or their reciprocal) in large quantities.
For example, pow(3, 5) is equivalent to the expression 3*3*3*3*3 and pow(3, -5)
is equivalent to 1 / 3*3*3*3*3.

@param {int|float} num        base of the exponential expression
@param {int|float} exponent   power of which to raise the base

@returns {float}

@see sqrt

pow = Math.pow


Calculates the integer closest to the value parameter. For example, round(9.2) returns the value 9.

@param {float} value        number to round

@returns {int}

@see floor
@see ceil

round = Math.round


Squares a number (multiplies a number by itself). The result is always a positive number,
as multiplying two negative numbers always yields a positive result. For example, -1 * -1 = 1.

@param {float} value        int or float

@returns {float}

@see sqrt

sq = (aNumber) -&gt;
  aNumber * aNumber



Calculates the square root of a number. The square root of a number is always positive,
even though there may be a valid negative root. The square root s of number a is such
that s*s = a. It is the opposite of squaring.

@param {float} value        int or float, non negative

@returns {float}

@see pow
@see sq

sqrt = Math.sqrt

</pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Trigonometry</p>             </td>             <td class="code">               <div class="highlight"><pre>
The inverse <span class="keyword">of</span> cos(), returns the arc cosine <span class="keyword">of</span> a value. This <span class="reserved">function</span> expects the
values <span class="keyword">in</span> the range <span class="keyword">of</span> -<span class="number">1</span> to <span class="number">1</span> <span class="keyword">and</span> values are returned <span class="keyword">in</span> the range <span class="number">0</span> to PI (<span class="number">3.1415927</span>).

<span class="property">@param</span> {float} value        the value whose arc cosine <span class="keyword">is</span> to be returned

<span class="property">@returns</span> {float}

<span class="property">@see</span> cos
<span class="property">@see</span> asin
<span class="property">@see</span> atan

acos = Math.acos


The inverse <span class="keyword">of</span> sin(), returns the arc sine <span class="keyword">of</span> a value. This <span class="reserved">function</span> expects the values
<span class="keyword">in</span> the range <span class="keyword">of</span> -<span class="number">1</span> to <span class="number">1</span> <span class="keyword">and</span> values are returned <span class="keyword">in</span> the range -PI<span class="regexp">/2 to PI/</span><span class="number">2.</span>

<span class="property">@param</span> {float} value        the value whose arc sine <span class="keyword">is</span> to be returned

<span class="property">@returns</span> {float}

<span class="property">@see</span> sin
<span class="property">@see</span> acos
<span class="property">@see</span> atan

asin = Math.asin


The inverse <span class="keyword">of</span> tan(), returns the arc tangent <span class="keyword">of</span> a value. This <span class="reserved">function</span> expects the values
<span class="keyword">in</span> the range <span class="keyword">of</span> -Infinity to Infinity (exclusive) <span class="keyword">and</span> values are returned <span class="keyword">in</span> the range -PI<span class="regexp">/2 to PI/</span><span class="number">2</span> .

<span class="property">@param</span> {float} value        -Infinity to Infinity (exclusive)

<span class="property">@returns</span> {float}

<span class="property">@see</span> tan
<span class="property">@see</span> asin
<span class="property">@see</span> acos

atan = Math.atan


Calculates the angle (<span class="keyword">in</span> radians) from a specified point to the coordinate origin as measured from
the positive x-axis. Values are returned as a float <span class="keyword">in</span> the range from PI to -PI. The atan2() <span class="reserved">function</span>
<span class="keyword">is</span> most often used <span class="keyword">for</span> orienting geometry to the position <span class="keyword">of</span> the cursor. Note: The y-coordinate <span class="keyword">of</span> the
point <span class="keyword">is</span> the first parameter <span class="keyword">and</span> the x-coordinate <span class="keyword">is</span> the second due the the structure <span class="keyword">of</span> calculating the tangent.

<span class="property">@param</span> {float} y        y-coordinate <span class="keyword">of</span> the point
<span class="property">@param</span> {float} x        x-coordinate <span class="keyword">of</span> the point

<span class="property">@returns</span> {float}

<span class="property">@see</span> tan

atan2 = Math.atan2


Calculates the cosine <span class="keyword">of</span> an angle. This <span class="reserved">function</span> expects the values <span class="keyword">of</span> the angle parameter to be provided
<span class="keyword">in</span> radians (values from <span class="number">0</span> to PI*<span class="number">2</span>). Values are returned <span class="keyword">in</span> the range -<span class="number">1</span> to <span class="number">1.</span>

<span class="property">@param</span> {float} value        an angle <span class="keyword">in</span> radians

<span class="property">@returns</span> {float}

<span class="property">@see</span> tan
<span class="property">@see</span> sin

cos = Math.cos


Converts a radian measurement to its corresponding value <span class="keyword">in</span> degrees. Radians <span class="keyword">and</span> degrees are two ways <span class="keyword">of</span>
measuring the same thing. There are <span class="number">360</span> degrees <span class="keyword">in</span> a circle <span class="keyword">and</span> <span class="number">2</span>*PI radians <span class="keyword">in</span> a circle. For example,
<span class="number">90</span> degrees = PI/<span class="number">2</span> = <span class="number">1.5707964</span>. All trigonometric methods <span class="keyword">in</span> Processing require their parameters to be specified <span class="keyword">in</span> radians.

<span class="property">@param</span> {int|float} value        an angle <span class="keyword">in</span> radians

<span class="property">@returns</span> {float}

<span class="property">@see</span> radians

<span class="function"><span class="title">degrees</span></span> = (aAngle) -&gt;
  (aAngle * <span class="number">180</span>) / Math.PI



Converts a degree measurement to its corresponding value <span class="keyword">in</span> radians. Radians <span class="keyword">and</span> degrees are two ways <span class="keyword">of</span>
measuring the same thing. There are <span class="number">360</span> degrees <span class="keyword">in</span> a circle <span class="keyword">and</span> <span class="number">2</span>*PI radians <span class="keyword">in</span> a circle. For example,
<span class="number">90</span> degrees = PI/<span class="number">2</span> = <span class="number">1.5707964</span>. All trigonometric methods <span class="keyword">in</span> Processing require their parameters to be specified <span class="keyword">in</span> radians.

<span class="property">@param</span> {int|float} value        an angle <span class="keyword">in</span> radians

<span class="property">@returns</span> {float}

<span class="property">@see</span> degrees

<span class="function"><span class="title">radians</span></span> = (aAngle) -&gt;
  (aAngle / <span class="number">180</span>) * Math.PI



Calculates the sine <span class="keyword">of</span> an angle. This <span class="reserved">function</span> expects the values <span class="keyword">of</span> the angle parameter to be provided <span class="keyword">in</span>
radians (values from <span class="number">0</span> to <span class="number">6.28</span>). Values are returned <span class="keyword">in</span> the range -<span class="number">1</span> to <span class="number">1.</span>

<span class="property">@param</span> {float} value        an angle <span class="keyword">in</span> radians

<span class="property">@returns</span> {float}

<span class="property">@see</span> cos
<span class="property">@see</span> radians

sin = Math.sin


Calculates the ratio <span class="keyword">of</span> the sine <span class="keyword">and</span> cosine <span class="keyword">of</span> an angle. This <span class="reserved">function</span> expects the values <span class="keyword">of</span> the angle
parameter to be provided <span class="keyword">in</span> radians (values from <span class="number">0</span> to PI*<span class="number">2</span>). Values are returned <span class="keyword">in</span> the range infinity to -infinity.

<span class="property">@param</span> {float} value        an angle <span class="keyword">in</span> radians

<span class="property">@returns</span> {float}

<span class="property">@see</span> cos
<span class="property">@see</span> sin
<span class="property">@see</span> radians

tan = Math.tan
currentRandom = Math.random


Generates random numbers. Each time the random() <span class="reserved">function</span> <span class="keyword">is</span> called, it returns an unexpected value within
the specified range. If one parameter <span class="keyword">is</span> passed to the <span class="reserved">function</span> it will <span class="keyword">return</span> a float between zero <span class="keyword">and</span> the
value <span class="keyword">of</span> the high parameter. The <span class="reserved">function</span> call random(<span class="number">5</span>) returns values between <span class="number">0</span> <span class="keyword">and</span> <span class="number">5</span> (starting at zero,
up to but <span class="keyword">not</span> including <span class="number">5</span>). If two parameters are passed, it will <span class="keyword">return</span> a float <span class="reserved">with</span> a value between the
parameters. The <span class="reserved">function</span> call random(-<span class="number">5</span>, <span class="number">10.2</span>) returns values starting at -<span class="number">5</span> up to (but <span class="keyword">not</span> including) <span class="number">10.2</span>.
To convert a floating-point random number to an integer, use the int() <span class="reserved">function</span>.

<span class="property">@param</span> {int|float} value1         <span class="keyword">if</span> one parameter <span class="keyword">is</span> used, the top end to random from, <span class="keyword">if</span> two params the low end
<span class="property">@param</span> {int|float} value2         the top end <span class="keyword">of</span> the random range

<span class="property">@returns</span> {float}

<span class="property">@see</span> randomSeed
<span class="property">@see</span> noise

<span class="function"><span class="title">random</span></span> = -&gt;
  <span class="keyword">return</span> currentRandom()  <span class="keyword">if</span> !arguments.length
  <span class="keyword">return</span> currentRandom() * arguments[<span class="number">0</span>]  <span class="keyword">if</span> arguments.length <span class="keyword">is</span> <span class="number">1</span>
  aMin = arguments[<span class="number">0</span>]
  aMax = arguments[<span class="number">1</span>]
  currentRandom() * (aMax - aMin) + aMin


</pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Pseudo-random generator</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="function"><span class="title">Marsaglia</span></span> = (i1, i2) -&gt;
  
</pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>from http://www.math.uni-bielefeld.de/~sillke/ALGORITHMS/random/marsaglia-c</p>             </td>             <td class="code">               <div class="highlight"><pre>  z = i1 <span class="keyword">or</span> <span class="number">362436069</span>
  w = i2 <span class="keyword">or</span> <span class="number">521288629</span>
  <span class="function"><span class="title">nextInt</span></span> = -&gt;
    z = (<span class="number">36969</span> * (z &amp; <span class="number">65535</span>) + (z &gt;&gt;&gt; <span class="number">16</span>)) &amp; <span class="number">0xFFFFFFFF</span>
    w = (<span class="number">18000</span> * (w &amp; <span class="number">65535</span>) + (w &gt;&gt;&gt; <span class="number">16</span>)) &amp; <span class="number">0xFFFFFFFF</span>
    (((z &amp; <span class="number">0xFFFF</span>) &lt;&lt; <span class="number">16</span>) | (w &amp; <span class="number">0xFFFF</span>)) &amp; <span class="number">0xFFFFFFFF</span>

  <span class="property">@nextDouble</span> = -&gt;
    i = nextInt() / <span class="number">4294967296</span>
    (<span class="keyword">if</span> i &lt; <span class="number">0</span> <span class="keyword">then</span> <span class="number">1</span> + i <span class="keyword">else</span> i)

  <span class="property">@nextInt</span> = nextInt

Marsaglia.<span class="function"><span class="title">createRandomized</span></span> = -&gt;
  now = <span class="keyword">new</span> Date()
  <span class="keyword">new</span> Marsaglia((now / <span class="number">60000</span>) &amp; <span class="number">0xFFFFFFFF</span>, now &amp; <span class="number">0xFFFFFFFF</span>)



Sets the seed value <span class="keyword">for</span> random(). By <span class="reserved">default</span>, random() produces different results each time the
program <span class="keyword">is</span> run. Set the value parameter to a constant to <span class="keyword">return</span> the same pseudo-random numbers
each time the software <span class="keyword">is</span> run.

<span class="property">@param</span> {int|float} seed         int

<span class="property">@see</span> random
<span class="property">@see</span> noise
<span class="property">@see</span> noiseSeed

<span class="function"><span class="title">randomSeed</span></span> = (seed) -&gt;
  currentRandom = (<span class="keyword">new</span> Marsaglia(seed)).nextDouble


</pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Random
We have two random()'s in the code... what does this do ? and which one is current ?</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="function"><span class="title">Random</span></span> = (seed) -&gt;
  haveNextNextGaussian = <span class="literal">false</span>
  nextNextGaussian = <span class="literal">undefined</span>
  random = <span class="literal">undefined</span>
  <span class="property">@nextGaussian</span> = -&gt;
    <span class="keyword">if</span> haveNextNextGaussian
      haveNextNextGaussian = <span class="literal">false</span>
      <span class="keyword">return</span> nextNextGaussian
    v1 = <span class="literal">undefined</span>
    v2 = <span class="literal">undefined</span>
    s = <span class="literal">undefined</span>
    <span class="keyword">loop</span>
      v1 = <span class="number">2</span> * random() - <span class="number">1</span> <span class="comment"># between -1.0 and 1.0</span>
      v2 = <span class="number">2</span> * random() - <span class="number">1</span> <span class="comment"># between -1.0 and 1.0</span>
      s = v1 * v1 + v2 * v2
      <span class="keyword">break</span> <span class="keyword">unless</span> s &gt;= <span class="number">1</span> <span class="keyword">or</span> s <span class="keyword">is</span> <span class="number">0</span>
    multiplier = Math.sqrt(-<span class="number">2</span> * Math.log(s) / s)
    nextNextGaussian = v2 * multiplier
    haveNextNextGaussian = <span class="literal">true</span>
    v1 * multiplier

  
</pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>by default use standard random, otherwise seeded</p>             </td>             <td class="code">               <div class="highlight"><pre>  random = (<span class="keyword">if</span> (seed <span class="keyword">is</span> `<span class="javascript"><span class="literal">undefined</span></span>`) <span class="keyword">then</span> Math.random <span class="keyword">else</span> (<span class="keyword">new</span> Marsaglia(seed)).nextDouble)


</pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Noise functions and helpers</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="function"><span class="title">PerlinNoise</span></span> = (seed) -&gt;
  
</pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>http://www.noisemachine.com/talk1/17b.html
http://mrl.nyu.edu/~perlin/noise/
generate permutation</p>             </td>             <td class="code">               <div class="highlight"><pre>  
</pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>copy to avoid taking mod in perm[0];</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="function"><span class="title">grad3d</span></span> = (i, x, y, z) -&gt;
    h = i &amp; <span class="number">15</span> <span class="comment"># convert into 12 gradient directions</span>
    u = (<span class="keyword">if</span> h &lt; <span class="number">8</span> <span class="keyword">then</span> x <span class="keyword">else</span> y)
    v = (<span class="keyword">if</span> h &lt; <span class="number">4</span> <span class="keyword">then</span> y <span class="keyword">else</span> (<span class="keyword">if</span> h <span class="keyword">is</span> <span class="number">12</span> <span class="keyword">or</span> h <span class="keyword">is</span> <span class="number">14</span> <span class="keyword">then</span> x <span class="keyword">else</span> z))
    ((<span class="keyword">if</span> (h &amp; <span class="number">1</span>) <span class="keyword">is</span> <span class="number">0</span> <span class="keyword">then</span> u <span class="keyword">else</span> -u)) + ((<span class="keyword">if</span> (h &amp; <span class="number">2</span>) <span class="keyword">is</span> <span class="number">0</span> <span class="keyword">then</span> v <span class="keyword">else</span> -v))
  <span class="function"><span class="title">grad2d</span></span> = (i, x, y) -&gt;
    v = (<span class="keyword">if</span> (i &amp; <span class="number">1</span>) <span class="keyword">is</span> <span class="number">0</span> <span class="keyword">then</span> x <span class="keyword">else</span> y)
    (<span class="keyword">if</span> (i &amp; <span class="number">2</span>) <span class="keyword">is</span> <span class="number">0</span> <span class="keyword">then</span> -v <span class="keyword">else</span> v)
  <span class="function"><span class="title">grad1d</span></span> = (i, x) -&gt;
    (<span class="keyword">if</span> (i &amp; <span class="number">1</span>) <span class="keyword">is</span> <span class="number">0</span> <span class="keyword">then</span> -x <span class="keyword">else</span> x)
  <span class="function"><span class="title">lerp</span></span> = (t, a, b) -&gt;
    a + t * (b - a)
  rnd = (<span class="keyword">if</span> seed <span class="keyword">isnt</span> `<span class="javascript"><span class="literal">undefined</span></span>` <span class="keyword">then</span> <span class="keyword">new</span> Marsaglia(seed) <span class="keyword">else</span> Marsaglia.createRandomized())
  i = <span class="literal">undefined</span>
  j = <span class="literal">undefined</span>
  perm = <span class="keyword">new</span> Uint8Array(<span class="number">512</span>)
  i = <span class="number">0</span>
  <span class="keyword">while</span> i &lt; <span class="number">256</span>
    perm[i] = i
    ++i
  i = <span class="number">0</span>
  <span class="keyword">while</span> i &lt; <span class="number">256</span>
    t = perm[j = rnd.nextInt() &amp; <span class="number">0xFF</span>]
    perm[j] = perm[i]
    perm[i] = t
    ++i
  i = <span class="number">0</span>
  <span class="keyword">while</span> i &lt; <span class="number">256</span>
    perm[i + <span class="number">256</span>] = perm[i]
    ++i
  <span class="property">@noise3d</span> = (x, y, z) -&gt;
    X = Math.floor(x) &amp; <span class="number">255</span>
    Y = Math.floor(y) &amp; <span class="number">255</span>
    Z = Math.floor(z) &amp; <span class="number">255</span>
    x -= Math.floor(x)
    y -= Math.floor(y)
    z -= Math.floor(z)
    fx = (<span class="number">3</span> - <span class="number">2</span> * x) * x * x
    fy = (<span class="number">3</span> - <span class="number">2</span> * y) * y * y
    fz = (<span class="number">3</span> - <span class="number">2</span> * z) * z * z
    p0 = perm[X] + Y
    p00 = perm[p0] + Z
    p01 = perm[p0 + <span class="number">1</span>] + Z
    p1 = perm[X + <span class="number">1</span>] + Y
    p10 = perm[p1] + Z
    p11 = perm[p1 + <span class="number">1</span>] + Z
    lerp fz, lerp(fy, lerp(fx, grad3d(perm[p00], x, y, z), grad3d(perm[p10], x - <span class="number">1</span>, y, z)), lerp(fx, grad3d(perm[p01], x, y - <span class="number">1</span>, z), grad3d(perm[p11], x - <span class="number">1</span>, y - <span class="number">1</span>, z))), lerp(fy, lerp(fx, grad3d(perm[p00 + <span class="number">1</span>], x, y, z - <span class="number">1</span>), grad3d(perm[p10 + <span class="number">1</span>], x - <span class="number">1</span>, y, z - <span class="number">1</span>)), lerp(fx, grad3d(perm[p01 + <span class="number">1</span>], x, y - <span class="number">1</span>, z - <span class="number">1</span>), grad3d(perm[p11 + <span class="number">1</span>], x - <span class="number">1</span>, y - <span class="number">1</span>, z - <span class="number">1</span>)))

  <span class="property">@noise2d</span> = (x, y) -&gt;
    X = Math.floor(x) &amp; <span class="number">255</span>
    Y = Math.floor(y) &amp; <span class="number">255</span>
    x -= Math.floor(x)
    y -= Math.floor(y)
    fx = (<span class="number">3</span> - <span class="number">2</span> * x) * x * x
    fy = (<span class="number">3</span> - <span class="number">2</span> * y) * y * y
    p0 = perm[X] + Y
    p1 = perm[X + <span class="number">1</span>] + Y
    lerp fy, lerp(fx, grad2d(perm[p0], x, y), grad2d(perm[p1], x - <span class="number">1</span>, y)), lerp(fx, grad2d(perm[p0 + <span class="number">1</span>], x, y - <span class="number">1</span>), grad2d(perm[p1 + <span class="number">1</span>], x - <span class="number">1</span>, y - <span class="number">1</span>))

  <span class="property">@noise1d</span> = (x) -&gt;
    X = Math.floor(x) &amp; <span class="number">255</span>
    x -= Math.floor(x)
    fx = (<span class="number">3</span> - <span class="number">2</span> * x) * x * x
    lerp fx, grad1d(perm[X], x), grad1d(perm[X + <span class="number">1</span>], x - <span class="number">1</span>)


</pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>processing defaults</p>             </td>             <td class="code">               <div class="highlight"><pre>noiseProfile =
  generator: `undefined`
  octaves: 4
  fallout: 0.5
  seed: `undefined`



Returns the Perlin noise value at specified coordinates. Perlin noise is a random sequence
generator producing a more natural ordered, harmonic succession of numbers compared to the
standard random() function. It was invented by Ken Perlin in the 1980s and been used since
in graphical applications to produce procedural textures, natural motion, shapes, terrains etc.
The main difference to the random() function is that Perlin noise is defined in an infinite
n-dimensional space where each pair of coordinates corresponds to a fixed semi-random value
(fixed only for the lifespan of the program). The resulting value will always be between 0.0
and 1.0. Processing can compute 1D, 2D and 3D noise, depending on the number of coordinates
given. The noise value can be animated by moving through the noise space as demonstrated in
the example above. The 2nd and 3rd dimension can also be interpreted as time.
The actual noise is structured similar to an audio signal, in respect to the function's use
of frequencies. Similar to the concept of harmonics in physics, perlin noise is computed over
several octaves which are added together for the final result.
Another way to adjust the character of the resulting sequence is the scale of the input
coordinates. As the function works within an infinite space the value of the coordinates
doesn't matter as such, only the distance between successive coordinates does (eg. when using
noise() within a loop). As a general rule the smaller the difference between coordinates, the
smoother the resulting noise sequence will be. Steps of 0.005-0.03 work best for most applications,
but this will differ depending on use.

@param {float} x          x coordinate in noise space
@param {float} y          y coordinate in noise space
@param {float} z          z coordinate in noise space

@returns {float}

@see random
@see noiseDetail

noise = (x, y, z) -&gt;
  
</pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>caching</p>             </td>             <td class="code">               <div class="highlight"><pre>  noiseProfile.generator = <span class="keyword">new</span> PerlinNoise(noiseProfile.seed)  <span class="keyword">if</span> noiseProfile.generator <span class="keyword">is</span> `<span class="javascript"><span class="literal">undefined</span></span>`
  generator = noiseProfile.generator
  effect = <span class="number">1</span>
  k = <span class="number">1</span>
  sum = <span class="number">0</span>
  i = <span class="number">0</span>

  <span class="keyword">while</span> i &lt; noiseProfile.octaves
    effect *= noiseProfile.fallout
    <span class="keyword">switch</span> arguments.length
      <span class="keyword">when</span> <span class="number">1</span>
        sum += effect * (<span class="number">1</span> + generator.noise1d(k * x)) / <span class="number">2</span>
      <span class="keyword">when</span> <span class="number">2</span>
        sum += effect * (<span class="number">1</span> + generator.noise2d(k * x, k * y)) / <span class="number">2</span>
      <span class="keyword">when</span> <span class="number">3</span>
        sum += effect * (<span class="number">1</span> + generator.noise3d(k * x, k * y, k * z)) / <span class="number">2</span>
    k *= <span class="number">2</span>
    ++i
  sum



Adjusts the character <span class="keyword">and</span> level <span class="keyword">of</span> detail produced <span class="keyword">by</span> the Perlin noise <span class="reserved">function</span>.
Similar to harmonics <span class="keyword">in</span> physics, noise <span class="keyword">is</span> computed over several octaves. Lower octaves
contribute more to the output signal <span class="keyword">and</span> as such define the overal intensity <span class="keyword">of</span> the noise,
whereas higher octaves create finer grained details <span class="keyword">in</span> the noise sequence. By <span class="reserved">default</span>,
noise <span class="keyword">is</span> computed over <span class="number">4</span> octaves <span class="reserved">with</span> each octave contributing exactly half than its
predecessor, starting at <span class="number">50</span>% strength <span class="keyword">for</span> the <span class="number">1</span>st octave. This falloff amount can be
changed <span class="keyword">by</span> adding an additional <span class="reserved">function</span> parameter. Eg. a falloff factor <span class="keyword">of</span> <span class="number">0.75</span> means
each octave will now have <span class="number">75</span>% impact (<span class="number">25</span>% less) <span class="keyword">of</span> the previous lower octave. Any value
between <span class="number">0.0</span> <span class="keyword">and</span> <span class="number">1.0</span> <span class="keyword">is</span> valid, however note that values greater than <span class="number">0.5</span> might result <span class="keyword">in</span>
greater than <span class="number">1.0</span> values returned <span class="keyword">by</span> noise(). By changing these parameters, the signal
created <span class="keyword">by</span> the noise() <span class="reserved">function</span> can be adapted to fit very specific needs <span class="keyword">and</span> characteristics.

<span class="property">@param</span> {int} octaves          number <span class="keyword">of</span> octaves to be used <span class="keyword">by</span> the noise() <span class="reserved">function</span>
<span class="property">@param</span> {float} falloff        falloff factor <span class="keyword">for</span> each octave

<span class="property">@see</span> noise

<span class="function"><span class="title">noiseDetail</span></span> = (octaves, fallout) -&gt;
  noiseProfile.octaves = octaves
  noiseProfile.fallout = fallout  <span class="keyword">if</span> fallout <span class="keyword">isnt</span> `<span class="javascript"><span class="literal">undefined</span></span>`



Sets the seed value <span class="keyword">for</span> noise(). By <span class="reserved">default</span>, noise() produces different results each
time the program <span class="keyword">is</span> run. Set the value parameter to a constant to <span class="keyword">return</span> the same
pseudo-random numbers each time the software <span class="keyword">is</span> run.

<span class="property">@param</span> {int} seed         int

<span class="property">@returns</span> {float}

<span class="property">@see</span> random
<span class="property">@see</span> radomSeed
<span class="property">@see</span> noise
<span class="property">@see</span> noiseDetail

<span class="function"><span class="title">noiseSeed</span></span> = (seed) -&gt;
  noiseProfile.seed = seed
  noiseProfile.generator = `<span class="javascript"><span class="literal">undefined</span></span>`
</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 